varStruct is a variational reimplementation of the Structure algorithm by Pritchard et al. 

You can compile varStruct from source by using the provided makefile, by executing the command "make"

Usage instructions:

usage: ./varstruct -d <data-file> -o <output dir> -k <number of pops> -r <random seed> -n <number of individuals> -m <number of loci> -p <ploidy>

<data-file> is a file containing the genotype data. Its format is as follows:
===========================================================================
There are P lines per individual, each line containing M entries separated by spaces. Missing genotypes are represented using the value -9.
===========================================================================
The data file has N*P lines in total.

<output dir> is the directory in which the output files are stored. This directory must be present for the output to be saved.

<number of pops> is the number of ancestral populations that you want to infer from the data.

<random seed> is the OPTIONAL random seed that is used to randomly initialize the inference.

Output:
Every few iterations, the program outputs the value of the inferred variational parameters as well as the model parameters (as described in the paper). They are stored in the files with the following suffixes:

.gamma - The variational \gamma parameters. The parameters for each individual are stored on a single line.

.theta - The inferred \theta parameters.

.beta - The ancestral allele frequency matrix.

.rhos - The variational \rho parameters.

.centroids - The allele centroids \mu.

.general - The first line stores the number of populations K, the number of loci M, and the ploidy of the data P.
This is followed by M lines. Each lines contains a single number describing how many ancestral loci are present at that loci.

Other notes:
1) To obtain the best model (for a given number of populations), run the program multiple times with different values for the random seed.


